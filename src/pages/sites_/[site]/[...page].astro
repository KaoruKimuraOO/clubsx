---
import { pageFactory } from '@devprotocol/clubs-core'
import Layout from '@layouts/Default.astro'
import { config } from '@fixtures/config'
import buy from '@plugins/buy'
import community from '@plugins/community'
import fiat from '@plugins/fiat'
import home from '@plugins/home'
import join from '@plugins/join'
import me from '@plugins/me'
import members from '@plugins/members'
import nft from '@plugins/nft'
import perks from '@plugins/perks'
import quests from '@plugins/quests'

const { site, page } = Astro.params

const { getStaticPaths } = await pageFactory({
  config: () => config(site),
  plugins: {
    buy,
    community,
    fiat,
    home,
    join,
    me,
    members,
    nft,
    perks,
    quests,
  },
})

const path = getStaticPaths().find(({ params }) => params.page === page)

if (!path) {
  throw new Error('Path undefined: ', path)
}

const Content = path.props.component
---

<Layout>
  <Content {...path.props} />
</Layout>
