---
import AdminMembershipsForm from '@components/AdminMembershipsForm/AdminMembershipsForm.svelte'
import { config as _config } from '@fixtures/config'
import { adminFactory } from '@devprotocol/clubs-core'
import memberships from '@plugins/memberships'
import SetupLayout from '@layouts/Setup.astro'

const { site } = Astro.params

const { getStaticPaths, getCurrentConfig } = adminFactory({
  config: async () => await _config(site),
  plugins: {
    memberships,
  },
})

const config = await getCurrentConfig()
const path = (await getStaticPaths()).find(
  ({ params }) => params.page === 'memberships'
)

if (!path) {
  throw new Error('Path undefined: ', path)
}

const clubs = path.props.clubs
---

<SetupLayout {config} {...path.props} setupStep="MEMBERSHIPS">
  <h1 class="mb-8 font-title text-lg font-bold">Memberships</h1>

  <div class="mb-8 text-2xl">
    Create a new Membership by selecting a template
  </div>

  <AdminMembershipsForm currentPluginIndex={clubs.currentPluginIndex} />
</SetupLayout>
